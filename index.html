<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cotizador</title>

  <!-- Supabase CDN -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>

  <!-- html2pdf.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

  <!-- Script principal -->
  <script defer src="script.js"></script>

  <!-- Estilos -->
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <main style="padding: 20px;">
    <h1>Cotización</h1>

    <label for="quoteNumber">N° Cotización:
      <input type="text" id="quoteNumber" required />
    </label><br>

    <label for="quoteDate">Fecha:
      <input type="date" id="quoteDate" />
    </label><br><br>

    <!-- ✅ Casilla de metraje -->
    <label>
      <input type="checkbox" id="modoMetraje" onchange="alternarModoMetraje()" />
      Cotización con metraje
    </label><br><br>

    <table id="itemsTable" border="1" cellpadding="4" cellspacing="0">
      <thead>
        <tr id="cabeceraNormal">
          <th>#</th>
          <th>Descripción</th>
          <th>Cantidad</th>
          <th>Precio Unitario</th>
          <th>Total</th>
          <th></th>
        </tr>
        <!-- Cabecera alternativa (se mostrará desde JS si se usa metraje) -->
      </thead>
      <tbody></tbody>
    </table>

    <button onclick="addItem()">Agregar ítem</button><br><br>

    <p>Subtotal: <span id="subtotal">0.00</span></p>
    <p>IGV (18%): <span id="igv">0.00</span></p>
    <p>Total: <span id="total">0.00</span></p>

    <button onclick="guardarCotizacion()">Guardar Cotización</button>
    <button id="downloadBtn" style="display: none;" onclick="generarPDF()">Descargar PDF</button>

    <hr>

    <h2>Cotizaciones guardadas</h2>
    <table id="listaCotizaciones" border="1" cellpadding="4" cellspacing="0">
      <thead>
        <tr>
          <th>N°</th>
          <th>Fecha</th>
          <th>Total</th>
          <th>Ver</th>
          <th>PDF</th>
          <th>Eliminar</th> <!-- ✅ Nueva columna -->
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <div id="detalleCotizacion" style="margin-top: 20px;"></div>

    <!-- Contenedor oculto para el PDF -->
    <div id="pdfContainer" style="display: none;"></div>
  </main>
</body>
</html>
